<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Doubles Randomiser</title>
  <style>
    :root{
      --bg:#000;
      --panel:#0f0f0f;
      --panel-2:#111;
      --card:#323232e6;
      --card-2:#282828e6;
      --accent:#00ff00;
      --text:#fff;
      --muted:#bbb;
    }
    *{box-sizing:border-box}
    body{
      font-family: Arial, Helvetica, sans-serif;
      background:var(--bg);
      color:var(--text);
      margin:0; padding:0;
      text-align:center;
    }

    /* Top logo */
    .logo{ margin-top:20px }

    h1{ margin:10px 0 }

    p.desc{
      margin:10px auto 20px;
      width:90%; max-width:540px; line-height:1.5em;
      color:var(--text);
    }

    /* Input “cards” for better mobile UX */
    .inputs{
      margin:15px auto;
      display:flex; justify-content:center; flex-wrap:wrap; gap:30px;
      max-width:540px;
    }
    .inputs-card{
      background:var(--panel);
      border:1px solid #1b1b1b;
      border-radius:14px;
      padding:14px 16px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.04), 0 6px 16px rgba(0,0,0,0.35);
      width:100%;
    }
    .inputs.split{ gap:30px }
    .inputs.split .inputs-card{ width:calc(50% - 15px) }

    label{
      display:flex; flex-direction:column; align-items:center; gap:6px;
      font-size:16px; font-weight:700;
    }
    input[type="number"]{
      width:78px; height:44px;
      text-align:center; font-size:18px;
      padding:6px 8px;
      border-radius:10px; border:none;
      background:#f5f5f5; color:#111;
    }

    /* Button with 3D depth + neon glow */
    .button-container{ margin:30px 0 26px } /* balanced between input & heading */
    button{
      padding:14px 28px; font-size:20px; cursor:pointer; border:none; border-radius:10px;
      color:#fff; background: linear-gradient(#1a1a1a,#0d0d0d);
      position:relative; z-index:1;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.08),
        inset 0 -2px 0 rgba(0,0,0,0.6),
        0 0 20px 5px var(--accent);
      transition: transform .08s ease, filter .15s ease;
      animation: btnPulse 2s infinite;
    }
    button:active{ transform: translateY(1px); filter: brightness(1.03) }

    /* Chalk swipe */
    button::after{
      content:""; position:absolute; top:-20%; left:-60%;
      width:40%; height:140%;
      background:linear-gradient(75deg, rgba(255,255,255,.0) 0%, rgba(255,255,255,.14) 45%, rgba(255,255,255,.0) 90%);
      transform: rotate(8deg);
      pointer-events:none;
      opacity:0;
    }
    .swipe::after{
      animation: chalkSwipe .75s ease-out both;
    }

    @keyframes btnPulse{
      0%{ box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), inset 0 -2px 0 rgba(0,0,0,0.6), 0 0 12px 2px var(--accent) }
      50%{ box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), inset 0 -2px 0 rgba(0,0,0,0.6), 0 0 26px 9px var(--accent) }
      100%{ box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), inset 0 -2px 0 rgba(0,0,0,0.6), 0 0 12px 2px var(--accent) }
    }
    @keyframes chalkSwipe{
      0%{ left:-60%; opacity:0 }
      10%{ opacity:1 }
      100%{ left:120%; opacity:0 }
    }

    /* Results area with pool-table glow */
    #result{
      margin-top:10px; font-size:20px; font-weight:700;
    }
    .results-bg{
      background: radial-gradient(circle, rgba(0,128,0,0.22) 0%, rgba(0,0,0,1) 85%);
      padding:15px 0; border-radius:20px;
      margin:15px auto; max-width:540px;
    }
    .matchups-heading{
      font-size:22px; margin:12px 0 14px;
      display:inline-block; padding-bottom:5px;
      border-bottom:2px solid var(--accent);
    }

    /* Loading state */
    .loading{ color:var(--muted); font-weight:600; margin:8px 0 4px }
    .dots::after{
      display:inline-block; min-width:1ch; content:"";
      animation: dots 1s steps(4,end) infinite;
    }
    @keyframes dots{
      0%{ content:"" } 25%{ content:"." } 50%{ content:".." } 75%{ content:"..." } 100%{ content:"" }
    }

    /* Match cards */
    .match-card{
      display:flex; justify-content:center; align-items:center;
      margin:10px auto; border-radius:16px; max-width:520px; padding:12px;
      background:var(--card);
    }
    .match-card:nth-child(even){ background:var(--card-2) }

    .team{
      flex:1; display:flex; align-items:center; justify-content:center; gap:10px;
      background:#222; margin:0 10px; padding:10px 12px; border-radius:12px; font-size:18px;
      opacity:0; transform: translateY(10px);
      transition: opacity .5s ease, transform .5s cubic-bezier(.22,1.2,.36,1);
      will-change: transform, opacity;
    }
    .team-a{ transform: translateX(-30px) }
    .team-b{ transform: translateX(30px) }
    .team.show{ opacity:1; transform: translateX(0) translateY(0) }

    /* Pool ball icons */
    .ball{
      width:16px; height:16px; border-radius:50%; box-shadow: inset 0 1px 2px rgba(255,255,255,.4), 0 0 0 1px rgba(0,0,0,.6);
    }
    .ball.red{ background: radial-gradient(circle at 30% 30%, #ff8c8c 0%, #cc0000 70%) }
    .ball.yellow{ background: radial-gradient(circle at 30% 30%, #fff2a1 0%, #caa300 70%) }

    /* VS neon */
    .vs{
      font-size:22px; font-weight:800; color:var(--accent);
      text-shadow:0 0 8px var(--accent);
      margin:0 2px; min-width:3ch;
    }
    .vs.flicker{ animation: neonFlicker .85s linear 1, vsPulse 3s infinite .85s }
    @keyframes vsPulse{
      0%,100%{ text-shadow:0 0 8px var(--accent) }
      50%{ text-shadow:0 0 20px var(--accent) }
    }
    @keyframes neonFlicker{
      0%{ opacity:.2; text-shadow:none }
      15%{ opacity:1 }
      30%{ opacity:.4 }
      45%{ opacity:1 }
      60%{ opacity:.5 }
      75%{ opacity:1 }
      100%{ opacity:1 }
    }
  </style>
</head>
<body>
  <!-- Top logo -->
  <img src="https://i.imgur.com/yTCNg6N.png" alt="Chalky Player Logo" width="120" class="logo"/>

  <h1>Doubles Randomiser</h1>
  <p class="desc">
    Welcome to the Chalky Trousers Doubles Drawer.
    Pop your team sizes in, smash that "Rack 'Em" button, and let fate (and a dodgy algorithm) decide who’s lumped with who.
  </p>

  <!-- Team sizes in split cards -->
  <div class="inputs split">
    <div class="inputs-card">
      <label>Team A size:
        <input type="number" id="teamASize" value="4" min="2"/>
      </label>
    </div>
    <div class="inputs-card">
      <label>Team B size:
        <input type="number" id="teamBSize" value="4" min="2"/>
      </label>
    </div>
  </div>

  <!-- Matches to make -->
  <div class="inputs">
    <div class="inputs-card" style="border:1px solid #1a1a1a;">
      <label>Doubles matches to make:
        <input type="number" id="matchCount" value="1" min="1"/>
      </label>
    </div>
  </div>

  <!-- Action -->
  <div class="button-container">
    <button id="rackBtn" onclick="onRackEmClick()">Rack ’Em!</button>
  </div>

  <!-- Results -->
  <div id="result" class="results-bg">
    <div class="matchups-heading">Matchups</div>
    <div id="pairs"></div>
  </div>

  <!-- Bottom logo -->
  <div style="margin:26px 0 20px">
    <img src="https://i.imgur.com/Tmxwc47.png" alt="Chalky Trousers Logo" width="200"/>
  </div>

  <script>
    const rackBtn = document.getElementById('rackBtn');

    function onRackEmClick(){
      const teamASize = parseInt(document.getElementById("teamASize").value);
      const teamBSize = parseInt(document.getElementById("teamBSize").value);
      const matchCount = parseInt(document.getElementById("matchCount").value);

      // quick chalk swipe
      rackBtn.classList.remove('swipe');
      void rackBtn.offsetWidth; // reflow to restart animation
      rackBtn.classList.add('swipe');

      // validation
      const pairsDiv = document.getElementById("pairs");
      if (teamASize < 2 || teamBSize < 2){
        pairsDiv.innerHTML = "<p class='error'>⚠️ Each team must have at least 2 players to form doubles.</p>";
        document.getElementById("result").scrollIntoView({behavior:"smooth", block:"center"});
        return;
      }
      const maxMatchesA = Math.floor(teamASize/2);
      const maxMatchesB = Math.floor(teamBSize/2);
      if (matchCount > maxMatchesA || matchCount > maxMatchesB){
        pairsDiv.innerHTML = "<p class='error'>⚠️ Not enough players in each team to make that many doubles matches!</p>";
        document.getElementById("result").scrollIntoView({behavior:"smooth", block:"center"});
        return;
      }

      // loading feedback
      rackBtn.disabled = true;
      pairsDiv.innerHTML = `<div class="loading">Shuffling players<span class="dots"></span></div>`;
      document.getElementById("result").scrollIntoView({behavior:"smooth", block:"center"});

      setTimeout(()=>{
        generatePairs(teamASize, teamBSize, matchCount);
        rackBtn.disabled = false;
      }, 600); // slight suspense
    }

    function generatePairs(teamASize, teamBSize, matchCount){
      let teamA = Array.from({length: teamASize}, (_, i)=>`A${i+1}`);
      let teamB = Array.from({length: teamBSize}, (_, i)=>`B${i+1}`);
      shuffle(teamA); shuffle(teamB);

      const pairsDiv = document.getElementById("pairs");
      pairsDiv.innerHTML = "";

      for(let i=0; i<matchCount; i++){
        const pairA = teamA.splice(0,2).join(" + ");
        const pairB = teamB.splice(0,2).join(" + ");

        const card = document.createElement('div');
        card.className = 'match-card';

        const teamADiv = document.createElement('div');
        teamADiv.className = 'team team-a';
        teamADiv.innerHTML = `<span class="ball red"></span><span>${pairA}</span>`;

        const vsDiv = document.createElement('div');
        vsDiv.className = 'vs';
        vsDiv.textContent = 'VS';

        const teamBDiv = document.createElement('div');
        teamBDiv.className = 'team team-b';
        teamBDiv.innerHTML = `<span class="ball yellow"></span><span>${pairB}</span>`;

        card.appendChild(teamADiv);
        card.appendChild(vsDiv);
        card.appendChild(teamBDiv);
        pairsDiv.appendChild(card);

        // Staggered reveal: Team A -> VS flicker -> Team B
        const base = i*700;
        setTimeout(()=> teamADiv.classList.add('show'), base + 50);
        setTimeout(()=>{
          vsDiv.classList.add('flicker');
          // remove flicker class after it runs once, leave pulse going
          setTimeout(()=> vsDiv.classList.remove('flicker'), 900);
        }, base + 350);
        setTimeout(()=> teamBDiv.classList.add('show'), base + 420);
      }
    }

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]] = [arr[j],arr[i]];
      }
    }
  </script>
</body>
</html>
